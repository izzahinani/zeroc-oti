(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[809],{809:function(a,b,c){"use strict";c.d(b,{Z:function(){return y}});var d=c(8788),e=c(865),f=c(6670),g=c(4776),h=c.n(g),i=c(2322),j=c(9644),k=c.n(j),l=c(2784),m=c(2325),n=c.n(m),o=function(){return(0,i.jsxs)("div",{className:n().ldsspinner,children:[(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{}),(0,i.jsx)("div",{})]})},p=c(7842),q=c(6297),r=c(8198),s=["name","source","year","scope","unit_type","sector","category","checkbox"],t=function(a){var b=a.results,c=a.checkedResults,d=a.confirmedResults,g=a.setCheckedResults,h=a.setConfirmedResults,j=function(a){var b=a.uuid;g(function(c){var d=c[b],g=(0,q.Z)(c,[b].map(r.Z));return d?g:(0,f.Z)((0,e.Z)({},g),(0,p.Z)({},b,a))})},k=function(a){a.preventDefault(),h(function(a){return(0,e.Z)({},a,c)})},l=function(a){a.preventDefault()},m=function(a){h(function(b){return b[a],(0,q.Z)(b,[a].map(r.Z))}),g(function(b){return b[a],(0,q.Z)(b,[a].map(r.Z))})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{children:"==================== RENDERED RESULTS=========================="}),(0,i.jsxs)("form",{onSubmit:k,children:[(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:s.map(function(a){return(0,i.jsx)("th",{children:a},a)})})}),(0,i.jsx)("tbody",{children:b.map(function(a){var b,e,f=a.uuid,g=a.name,h=a.scope,k=a.source,l=a.year,m=a.unit_type,n=a.sector,o=a.category;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:g}),(0,i.jsx)("td",{children:k}),(0,i.jsx)("td",{children:l}),(0,i.jsx)("td",{children:void 0===h?"":h}),(0,i.jsx)("td",{children:m}),(0,i.jsx)("td",{children:n}),(0,i.jsx)("td",{children:o}),(0,i.jsx)("td",{children:(0,i.jsx)("input",{type:"checkbox",checked:(b=f,Object.keys(c).some(function(a){return a===b})),onChange:function(){return j(a)},disabled:(e=f,Object.keys(d).some(function(a){return a===e}))})})]},f)})})]}),(0,i.jsx)("button",{type:"submit",children:"Confirm"})]}),(0,i.jsx)("h2",{children:"==================== RENDERED CONFIRMED TABLE=========================="}),0===Object.keys(d).length?(0,i.jsx)("div",{children:"No confirmed table"}):(0,i.jsx)("form",{onSubmit:l,children:(0,i.jsxs)("table",{children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:s.map(function(a){return(0,i.jsx)("th",{children:a},a)})})}),(0,i.jsx)("tbody",{children:Object.keys(d).map(function(a){var b=d[a],c=b.uuid,e=b.name,f=b.scope,g=void 0===f?"":f,h=b.source,j=b.year,k=b.unit_type,l=b.sector,n=b.category;return(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e}),(0,i.jsx)("td",{children:h}),(0,i.jsx)("td",{children:j}),(0,i.jsx)("td",{children:g}),(0,i.jsx)("td",{children:k}),(0,i.jsx)("td",{children:l}),(0,i.jsx)("td",{children:n}),(0,i.jsx)("td",{children:(0,i.jsx)("button",{type:"button",onClick:function(){return m(c)},children:"X"})})]},c)})})]})})]})},u=c(2484),v=function(a){var b=a.state,c=a.query,d=a.setQuery;a.getQueryAPI;var g=(0,l.useRef)(null),h=function(a){var b=a.target,c=b.name,g=b.value;if(console.log(c,g),"query"===c){d(function(a){return(0,f.Z)((0,e.Z)({},a),(0,p.Z)({},c,g))});return}d(function(a){return a[c].find(function(a){return a===g})?(0,f.Z)((0,e.Z)({},a),(0,p.Z)({},c,(0,u.Z)(a[c].filter(function(a){return a!==g})))):(0,f.Z)((0,e.Z)({},a),(0,p.Z)({},c,(0,u.Z)(a[c]).concat([g])))})},j=function(a){a.preventDefault();var b=g.current.value;""!==b.trim()&&d(function(a){return(0,f.Z)((0,e.Z)({},a),{query:b})})},k=function(a){"prev"===a&&1!= +b.current_page?d(function(a){return(0,f.Z)((0,e.Z)({},a),{page:(+b.current_page-1).toString()})}):"next"===a&& +b.current_page+1!==b.last_page&&d(function(a){return(0,f.Z)((0,e.Z)({},a),{page:(+b.current_page+1).toString()})})},m=function(a,b){return c[a].includes(b)};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{children:["QUERIES: ",JSON.stringify(c)]}),(0,i.jsxs)("form",{onSubmit:j,children:[(0,i.jsx)("h2",{children:"====================MULTI SELECT DROPDOWN===================="}),(0,i.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat( auto-fit, minmax(250px, 1fr) )",width:"100%"},children:Object.keys(b.possible_filters).map(function(a){var c=b.possible_filters[a];return(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{children:a}),(0,i.jsx)("div",{style:{maxHeight:"150px",overflowY:"auto"},children:c.map(function(b){if("object"!=typeof(c=b)||Array.isArray(c)||null===c)return(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{type:"checkbox",defaultChecked:m(a,b),id:b,value:b,name:a,onChange:h}),(0,i.jsx)("label",{htmlFor:b,children:b})]});var c,d=b.id,e=b.name;return(0,i.jsxs)("div",{children:[(0,i.jsx)("input",{type:"checkbox",defaultChecked:m(a,d),id:d,value:d,name:a,onChange:h}),(0,i.jsx)("label",{htmlFor:d,children:e})]})})})]},a)})}),(0,i.jsx)("h2",{children:"====================SEARCH BY TEXT===================="}),(0,i.jsxs)("div",{style:{width:"100%"},children:[(0,i.jsx)("input",{type:"text",placeholder:"search...",style:{width:"80%"},ref:g}),(0,i.jsx)("button",{type:"submit",children:"Search"})]}),(0,i.jsx)("h2",{children:"====================PAGINATION===================="}),(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{type:"button",onClick:function(){return k("prev")},children:"Prev"}),(0,i.jsxs)("p",{children:["Current: ",b.current_page]}),(0,i.jsx)("button",{type:"button",onClick:function(){return k("next")},children:"Next"}),(0,i.jsxs)("p",{children:["Last Page: ",b.last_page]}),(0,i.jsxs)("p",{children:["Total Results: ",b.total_results]})]})]})]})},w={current_page:1,last_page:753,total_results:15051,results:[{access_type:"public",activity_id:"accommodation_type_holiday",category:"Accommodation",constituent_gases:{co2e_total:.425,co2e_other:null,co2:null},data_quality_flags:[],description:"Emission intensity of supply chain in GBP spend on: holiday in the uk/ holiday abroad/ room hire. In actual prices in \xa3s and including VAT. Provided by BEIS/DEFRA in the official report on GHG Emissions of the UK between 1996-2018. Where source emission factors are identical across a variety of activities they have been grouped to avoid confusion - details are documented in the OEFDB data guidance.",factor:.425,factor_calculation_method:"ar4",factor_calculation_origin:"source",id:"accommodation_type_holiday",lca_activity:"unknown",name:"Holiday (travel/accommodation)",region:"GB",region_name:"United Kingdom",sector:"Restaurants and Accommodation",source:"BEIS",source_link:"https://www.gov.uk/government/statistics/uks-carbon-footprint",supported_calculation_methods:["ar4"],uncertainty:null,unit:"kg/GBP",unit_type:["Money"],uuid:"5c37ee77-488d-4a21-83d7-7c06656eb0ff",year:"2018"},],possible_filters:{category:[""],region:[{id:"",name:""}],sector:[""],source:[""],unit_type:[""],year:[""]}},x={category:[],region:[],sector:[],source:[],unit_type:[],year:[],query:"",page:"1"},y=function(){var a=(0,l.useState)(w),b=a[0],c=a[1],g=(0,l.useState)({}),j=g[0],m=g[1],n=(0,l.useState)({}),p=n[0],q=n[1],r=(0,l.useState)(x),s=r[0],u=r[1],y=(0,l.useState)(!0),z=y[0],A=y[1],B=(0,l.useState)({isLoading:!1,message:{type:"",message:""}}),C=B[0],D=B[1];(0,l.useEffect)(function(){z&&(0,d.Z)(h().mark(function a(){var b;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,D(function(a){return(0,f.Z)((0,e.Z)({},a),{isLoading:!0})}),a.next=4,k().get("/api/climatiq/orgadmin/getSearch");case 4:b=a.sent.data,console.log("data",b),c(b),D(function(a){return(0,f.Z)((0,e.Z)({},a),{isLoading:!1,message:{type:"success",message:"Successfully fetched"}})}),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(0),D(function(b){return(0,f.Z)((0,e.Z)({},b),{isLoading:!1,message:{type:"error",message:a.t0.message}})});case 13:case"end":return a.stop()}},a,null,[[0,10]])}))()},[]);var E=C.message.type;(0,l.useEffect)(function(){if(E){var a=setTimeout(function(){D(function(a){return(0,f.Z)((0,e.Z)({},a),{message:{type:"",message:""}})})},1e3);return function(){return clearTimeout(a)}}},[E]);var F=(0,l.useCallback)((0,d.Z)(h().mark(function a(){var b;return h().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,D(function(a){return(0,f.Z)((0,e.Z)({},a),{isLoading:!0})}),console.log("query",s),a.next=5,k().post("/api/climatiq/orgadmin/getSearch",{body:JSON.stringify(s)});case 5:b=a.sent.data,console.log("data",b),c(function(a){return(0,f.Z)((0,e.Z)({},b),{possible_filters:(0,e.Z)({},a.possible_filters)})}),D(function(a){return(0,f.Z)((0,e.Z)({},a),{isLoading:!1,message:{type:"success",message:"Successfully queried"}})}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),D(function(b){return(0,f.Z)((0,e.Z)({},b),{isLoading:!1,message:{type:"error",message:a.t0.message}})});case 14:case"end":return a.stop()}},a,null,[[0,11]])})),[s,c,D]);return((0,l.useEffect)(function(){if(z){A(!1);return}setTimeout(function(){return F()},[1e3])},[s,F]),C.isLoading)?(0,i.jsx)(o,{}):(0,i.jsxs)(i.Fragment,{children:[C.message.type&&(0,i.jsx)("div",{style:{backgroundColor:"success"===C.message.type?"green":"red"},children:(0,i.jsx)("p",{children:C.message.message})}),(0,i.jsx)("h1",{children:"Datapoints"}),(0,i.jsx)(v,{setState:c,setUi:D,state:b,query:s,setQuery:u,getQueryAPI:F}),0===b.results.length?(0,i.jsx)("div",{children:" NO RESULTS"}):(0,i.jsx)(t,{results:b.results,checkedResults:j,confirmedResults:p,setCheckedResults:m,setConfirmedResults:q})]})}},2325:function(a){a.exports={ldsspinner:"loader_ldsspinner__EfvyH"}}}])